<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>psa_test</title>
  <link rel="stylesheet" href="css/common.css">
  <!-- <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">   -->
  <!-- <script src="sw.js"></script> -->
  <script src="./jquery-3.2.1 .js"></script>
</head>
<body>
  <!-- <div class="name">于构建一个希望达到原生应用级别体验的PWA，目前社区里的主流做法都是采用SPA，即 单页面应用模型（Single-page App）来组织整个Web应用，业内最有名的几个PWA案例Twitter Lite、 Flipkart Lite、Housing Go 与 Polymer Shop无一例外。

    然而饿了么，与很多国内的电商网站一样，青睐多页面应用模型（MPA， Multi-page App）所能带来的一些好处，也因此在一年多前就将移动站从基于AngularJS的单页应用重构为目前的多页应用模型。团队最看重的优点莫过于页面与页面之间的隔离与解耦，这使得我们可以将每个页面当做一个独立的“微服务”来看待，这些服务可以被独立迭代，独立提供给各种第三方的入口嵌入，甚至被不同的团队独立维护。而整个网站则只是各种服务的集合而非一个巨大的整体。
    
    与此同时，我们仍然依赖 Vue.js作为Java框架。 Vue.js除了是React、 AngularJS这种“重型武器”的竞争对手外，其轻量与高性能的优点使得它同样可以作为传统多页应用开发中流行的“jQuery/Zepto/Kissy+模板引擎”技术栈的完美替代。 Vue.js提供的组件系统、声明式与响应式编程更是提升了代码组织、共享、数据流控制、渲染等各个环节的开发效率。 Vue 还是一个渐进式框架，如果网站的复杂度继续提升，我们可以按需、增量地引入Vuex或Vue-Router这些模块。万一哪天又要改回单页呢？（谁知道呢……）
    
    2017年， PWA已经成为Web应用新的风潮。我们决定试试，以我们现有的“Vue.js+多页”架构，能在升级PWA的道路上走多远，达到怎样的效果。</div>
  <img src="public/image/Koala.jpg" alt="图片"> -->
<button id="toPost">跨域请求</button>
<script>
  $(document).ready(function(){
    var params = {
        "header": {},
        "body": {
        //上送签名后的密文
        "sign": "t3iZ1J3UmtKG2HzayLG7aqRrxkUN5bEXZYn/9ZaaTIckDBXK395WfOtvj2YQpuU4Z/AeIbdULKkQt/aIRvnFub4IGkE/gDvYETH6xGwEX6B12hooBuSxhg2UYaPs1omWz8+lrta+44AzEfx1SYnyaJJJP/NG0YjXZgUPx7oYDdM=",
        "ordrno": "V6gVNkVpMyVIOoAgYKlRSr9ygjsIbsVVr3fjwgXvOufNRfv/9la1qQglxxL8qS6POxrgJ1gfLEyulDrSbioY1rteEyaisHRWvVieQzlOPV/aHu6Nc8krcmeIRj4ZT68ynKsEeat/XCSm6ykVwSHUPfiGyFx/QwiuKd+JnTrdLjI=",
        "aplyno": "pRhO0+burnh+c9mBUjld14Sf8/193CACUVIM1Ct/erYaUkLZnKBU+taxFkJZNKrpuHWQwXUMCEfMOu3IK7UkCcRJQ39rvYmjW2U6GqAlKnJBiRNtQptxdUMaQEn08IHknFYfMNOYrBRO2RWNZBGvJEVLj3n3oFQp6IweygpgOlY=",
        "mercno": "TuW4SrFlR6shiGoNTA3BpEJFbYAf26qRPTlIRM2R1CvB0DnybF6l/pZP6WeRqPShsC4VQ4l1H7ssTGleakvBcb9iuacYxHg2TQArM+nHXFyC/YBoDcXCGgHHMIWAFsobCebHxwBaZQhy+GZXt+Fl7RAJYr8dNbwBU6TOPitm0Xk=",
        "mercna": "jO2HMkxzRs+Bzsqhxr0dUpWWyQMZE0guuaRqejRWURtHyZGJwXAdIJd/dt30hWwL6wR2l/J9+oXvpqZrFAgCRsiFebK5KbenwBt0HibpzM6bFYLzFGOjdjBHGQtY4t60gtd9vcBW589ltO788q9IkiI8Vgnu2d+g0NIlOlyNCYc=",
        "custno": "XL/EnM5+1tJicMSrxHvCR6TY0LfbN7ls/TdXHn3oOuiyCGRKGpozD9HZDs3DBPp0O78ICbhB7AW97VfGATfCRuXE4bjFtQd7Ps0QiL6LWMtlrqjPh85JeG6KAafwSEpKzSgcUtDQW1/BLImp+8KlWNQUl1wGhD+paUv6vI189/I=",
        "custna": "bD171MjNuigdxsR/+p4PKaNEC4T4coHb+WdTiG59FgjUU+eag0fsz0h5sKVnZKEU5GmyAwK1up5Knbo4H8Z0kAkICQKGzvsesndCqbmMqiPfjmriSrnDA6YLNywGXRhMJorhnQc6YV/LQzJjOlgkdRVDpT/sF/H4IsWJeto4x40=",
        "cuphno": "lpIlPh6CSDUUR1qXnTurw345/hOQHPQtvqOa8Tlk4eQ4w33yKZYVjaaRqipx+6FSpNC5Knbi0LXzHcLfhx2VLianENTkD1SIFg6bdMXBvYgBgPP48SAVAAXn1ABhbb1SEY0gjg8oEz9op7Lq38AD0Fd7jclwOWBV5i4xbDSoJaw=",
        "commna": "mHieU40Oxu4lI150MvjeQAOCRH0HyL0IBDgqUGbTpAMzhxSaMyWMpoalXhyvuamV2fnaSakZGHiEc4xMiXEsP/V1G4bt4Q/8iU5X63DCwBRpf4stIUXLVMlKuK8CwEEvijc3PPi97ykE7ZZeMjHZrH2yUkHhu43Cesvfk8Fxrns=",
        "currcy": "Aq4RgQEgCEzLGznKH3znWf4MNbFln3yiMLQKVD7ao8AgIpqH1Z4K6vCpeZwLWb1PXBM/4/EE7XBU8b3OBOEs5lH8uZxm4W+csClXn/90az9S9Emdu+j0GV9w17aBfxmUSCXKlyfuK9h7DA9kSYXZk/9KRa9kB8+lfepmY/efYxs=",
        "paydat": "QCdMUntA+Oivs+399FTMvEr3PVDTxkSzwHSV0bHSCN2D1xeMOusuqRnGzQxE/BRlouWehW8llTkb+yvp0HStoDlFpJjZMIe9q0K1vdZzGbNBigXEFrqH5T8MRD0DDoyMlBfJ25DfxzvRnRy3RJEe6L4jR9cCD31nI8ldQu+3LY8=",
        "paytim": "YgA/Ci8bBe4M7Za62FppctIly3xVENurAMggF/JOA4/EQGtIAqR16ZjgljrT4fDMKqX32tB35UAuvJqHDXOkOawE2idvD6U9WYU9Z1ZwfosNeNYpeWYy53zVaRw+UtOONeSe/pIYdQvTD2WAKDhTN2L5rhjqiGM1ysqegT57JvI=",
        "taccty": "ThCnAKijUrIheMyl6ZKwMzJ2R+m0dYiO18rkYfCF4/rC/35fggTAQgKkNidwQmbzZA7Mfx/Yv6eKtSKXJuHmEyQuSYKVt/3CBepHD0YKL8Vd8TOK3ovSchGV7cv9YWx7p3E/q8PP9pWB3H0Q9bwwUsS6wJb3vdEAw+t6TJdGTJY=",
        "ordamt": "En5JDdUOXxR2AsCIJfJENVoAHPzhaKMBqrnjvZfUWeAklA5bwjJGu+OwSYwYxvxD4Kh+HlGHHhWCappHAgHXGe8P7t/OQ9h+ZIDbG8o59cYWDd3Sb4rHa1pQxEjtK5kuPH6PkfITJqLtvSNEEXBbrocA4mr8HjR0IQLOYUA+nAM=",
        "dirurl": "Mi46UO49sAuW0oeFMVMwy3QMT80I9XiN+Gm94n4NXVCz9NyvVz68BSWH2dqryjqPe85gxuIHnDGVnjpVWDBfYynVmSk/zavfxWEZMHS9nEsgcLb0grb01/1dGDfeGV/sjXNoHF/CQBYv1ZQcQ8t5uZHHECOXMxrB4OF8ejHr7GA="
        }
    }
    
    // let headers = {
    //     headers: {
    //         // 'responseFormat': 'JSON',
    //         'Content-Type': 'text/plain' 
    //     }
    // }
    $('#toPost').on('click', function() {
        $.ajax({
            type: 'POST',
            url: 'https://ebank.dgcb.com.cn:8501/support-channel/decorateLoan.do',
            data: JSON.stringify(params),
            success: function (data) {
              console.log(data)
              if (data.body.errcod == '0'){
                var win = window
                //重新跳转到路由
                win.location.href = data.body.url
              } else {
                alert(data.body.errmsg)
              }
            },
            // complete: function (xhr, status) {
            //   // 路由重定向,如果响应头中包含REDIRECT，则说明是拦截器返回的
            //   var REDIRECT = xhr.getResponseHeader("REDIRECT")
            //   if ("REDIRECT" == REDIRECT) {
            //   var win = window
            //   //返回当前浏览器顶层窗口
            //   while (win != win.top) {
            //     win = win.top 
            //   }
            //   //重新跳转到路由
            //   win.location.href = xhr.getResponseHeader("CONTENTPATH")
            //   }
            // }
        })
    })

  })
</script>
<script>
  // 注册 service worker
  // if ('serviceWorker' in navigator) {
  //   navigator.serviceWorker.register('sw.js').then(function (registration) {
  //     // 注册成功
  //     console.log('ServiceWorker registration successful with scope: ', registration.scope)
  //   }).catch(function (err) {
  //     // 注册失败
  //     console.log('ServiceWorker registration failed: ', err)
  //   })
  // }
</script>
</body>
</html>